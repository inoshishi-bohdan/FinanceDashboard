@page "/"

@using FinanceDashboard.Client.Authentication;


@inject IJSRuntime js;
@inject AuthenticationStateProvider authenticationStateProvider
@inject NavigationManager navManager

<PageTitle>Index</PageTitle>


<AuthorizeView>
    <Authorized>
        <h1>Hello, @context?.User?.Identity?.Name! &#x1F44B;</h1>
        <h5>Let's organize your finances &#10024;</h5>

    </Authorized>
</AuthorizeView>


@code {
    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();

        var customAuthStateProvider = (CustomAuthenticationStateProvider)authenticationStateProvider;
        var token = await customAuthStateProvider.GetToken();
        if (string.IsNullOrWhiteSpace(token))
        {
            navManager.NavigateTo("/login");
            return;
        }
    }
}